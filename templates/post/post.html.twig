{% extends 'base.html.twig' %}

{% block title %}Créer un nouvel article{% endblock %}

{% block body %}
<canvas id="gradient-canvas" style="width:100vw;height:100vh; opacity: 1; position: fixed; top: 0; left: 0; z-index: 0;"></canvas>
<script src="https://unpkg.com/detect-gpu@latest/dist/detect-gpu.umd.js"></script>
<script src="{{ asset('js/Gradient.js') }}"></script>
<script>
    async function detectGPU() {
        const gpuTier = await DetectGPU.getGPUTier()
        const hasGPUAcceleration = gpuTier.tier >= 2
        console.log("GPU Acceleration: " + hasGPUAcceleration);
        console.log("GPU Tier: " + gpuTier.tier);
        await processGPUResults(hasGPUAcceleration, gpuTier.tier)
    }

    async function processGPUResults(hasGPUAcceleration, gpuTier) {
        let gradientCanvas = document.getElementById('gradient-canvas')

        if (gpuTier === 0) {
            gradientCanvas.style.background = 'linear-gradient(318deg, rgba(96,146,236,1) 0%, rgba(56,103,156,1) 25%, rgba(36,36,56,1) 54%)';
        } else {
            new Gradient({
                canvas: '#gradient-canvas',
                colors: ['#1e202d', '#303f60', '#1e202d', '#1e202d'],
                static: gpuTier < 3,
            });
        }


        gradientCanvas.style.opacity = "1";

        await new Promise(resolve => setTimeout(resolve, 100));

        if (hasGPUAcceleration) {
            let shouldBlurElements = document.getElementsByClassName("element-item-container");
            for (let i = 0; i < shouldBlurElements.length; i++) {
                shouldBlurElements[i].style.backdropFilter = "blur(10px)";
            }

            let navbar = document.getElementById("taunahi-nav");
            if (navbar) {
                navbar.style.backdropFilter = "blur(10px)";
            }
        }

        for (const funcName of Object.getOwnPropertyNames(this)) {
            if (typeof this[funcName] === 'function' && funcName.startsWith("afterGpuCheck")) {
                const fn = window[funcName];
                fn(hasGPUAcceleration);
            }
        }
    }

    
    
        detectGPU();
    
</script>
<div style="margin-top: 120px; position: relative; z-index: 2;">
    <h1 style="text-align: center;">Créer un nouvel article</h1>
    <div class="container-form">
        {{ form_start(form, {'attr': {'class': 'post form'}}) }}
            {{ form_widget(form) }}
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" style="cursor: pointer;">Sauvegarder</button>
            </div>
        {{ form_end(form) }}
    </div>
</div>
{% endblock %}

{% block stylesheets %}
<style>
    *,
    *:before,
    *:after {
        padding: 5px;
        margin: 0;
        box-sizing: border-box;
    }
    body {
        background-color: #080710;
        font-family: 'Poppins', sans-serif;
        color: #ffffff;
        letter-spacing: 0.5px;
        outline: none;
        border: none;
    }
    .background {
        width: 100%;
        height: 300px;
        position: absolute;
        left: 0;
        top: 0;
        z-index: -1;
    }
    .background .shape {
        height: 200px;
        width: 200px;
        position: absolute;
        border-radius: 50%;
    }
    .shape:first-child {
        background: linear-gradient(
            #1845ad,
            #23a2f6
        );
        left: 16%;
        top: 100px;
    }
    .shape:last-child {
        background: linear-gradient(
            to right,
            #ff512f,
            #f09819
        );
        right: 16%;
        bottom: -500px;
    }
    .container-form {
        height: auto; /* Adjusted for content */
        width: 60%;
        background-color: rgba(255,255,255,0.13);
        margin-left: 20%;
        border-radius: 10px;
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255,255,255,0.1);
        box-shadow: 0 0 40px rgba(8,7,16,0.6);
        padding: 50px 35px;
    }
    .form {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    .form input, .form select, .form textarea {
        font-family: 'Poppins', sans-serif;
        color: #ffffff;
        background-color: rgba(255,255,255,0.07);
        border-radius: 3px;
        padding: 10px;
        margin-bottom: 15px; /* Assure un espacement uniforme */
    }
    .form input, .form select, .form textarea {
        width: calc(100% - 20px); /* Compense le padding pour un alignement complet */
    }
    .btn {
        background-color: #ffffff;
        color: #080710;
        padding: 15px 0;
        font-size: 18px;
        font-weight: 600;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease, color 0.3s ease;
    }
    .btn:hover {
        background-color: #080710;
        color: #ffffff;
    }
</style>
{% endblock %}
